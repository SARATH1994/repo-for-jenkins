pipeline {
     agent {
        label 'maven'
    }
    stages {
        stage('test') {
            steps {
               
              echo "xxxxxxxxxxxxx"
              sh '''
              mvn -version
              mvn package
		echo "testing"
		
              ls -lrt 
              oc login https://master:8443 --token=ZTt5C4AjnngN3gAnsdzVEEI-J0T8dT7mhZawFlxe5NE --insecure-skip-tls-verify=true
              oc project jenkins
              wget https://storage.googleapis.com/kubernetes-helm/helm-v2.12.1-linux-amd64.tar.gz
              tar -zxvf helm-v2.12.1-linux-amd64.tar.gz
	      cp linux-amd64/helm /usr/bin
              git clone https://github.com/SARATH1994/hello-world.git
 	      mv hello-world/README.md hello-world/index.html
	      helm version
              helm del --purge httpd
	      helm install ./httpd --version=1.0 --name=httpd
              helm init --client-only
	      helm repo update 
              helm list
	      sleep 30
	      x=`oc get pods | grep httpd | cut -d " " -f1`
              echo $x
              oc rsync ./hello-world "$x":/var/www/html --exclude=* --include=index.html
	      
		'''  
             }
            }
        }  
}


